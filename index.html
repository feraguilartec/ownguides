<html>
<head>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-look-at-component@1.0.0/dist/aframe-look-at-component.min.js"></script> 
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-xr-hand-tracking@1.2.0/dist/aframe-xr-hand-tracking.min.js"></script>
</head>
<body>
  <!-- <a-scene xr-mode-ui="XRMode: xr" xrweb="allowedFeatures: [ 'hand-tracking', 'eye-tracking' ]" raycaster="objects: .button" renderer="sortObjects: true; physicallyCorrectLights: false;">-->
  <a-scene obb-collider="showColliders: true" xr-mode-ui="XRMode: xr" xrweb="allowedFeatures: [ 'hand-tracking', 'eye-tracking' ]" raycaster="objects: .button" renderer="sortObjects: true; physicallyCorrectLights: false;"> 
    <a-assets>
      <img id="back_on" src="media/img/ui/back_on.png" alt="">
      <img id="back" src="media/img/ui/back.png" alt="">
      <img id="down_on" src="media/img/ui/down_on.png" alt="">
      <img id="down" src="media/img/ui/down.png" alt="">
      <img id="follow_on" src="media/img/ui/follow_on.png" alt="">
      <img id="follow" src="media/img/ui/follow.png" alt="">
      <img id="fwd_on" src="media/img/ui/fwd_on.png" alt="">
      <img id="fwd" src="media/img/ui/fwd.png" alt="">
      <img id="min_on" src="media/img/ui/min_on.png" alt="">
      <img id="min" src="media/img/ui/min.png" alt="">
      <img id="play_on" src="media/img/ui/play_on.png" alt="">
      <img id="play" src="media/img/ui/play.png" alt="">
      <img id="pause_on" src="media/img/ui/pause_on.png" alt="">
      <img id="pause" src="media/img/ui/pause.png" alt="">
      <img id="rotate_on" src="media/img/ui/rotate_on.png" alt="">
      <img id="rotate" src="media/img/ui/rotate.png" alt="">
      <img id="screen" src="media/img/ui/screen.png" alt="">
      <img id="screen_s" src="media/img/ui/screen_s.png" alt="">
      <img id="step_active" src="media/img/ui/step_on.png" alt="">
      <img id="step_on" src="media/img/ui/step_on.png" alt="">
      <img id="step" src="media/img/ui/step.png" alt="">
      <img id="steps_active" src="media/img/ui/steps_on.png" alt="">
      <img id="steps_on" src="media/img/ui/steps_on.png" alt="">
      <img id="steps" src="media/img/ui/steps.png" alt="">
      <img id="up_on" src="media/img/ui/up_on.png" alt="">
      <img id="up" src="media/img/ui/up.png" alt="">
      <img id="cascade_bg" src="media/img/ui/cascade_bg.png" alt="">
      <img id="page_bg" src="media/img/ui/page_bg.png" alt="">
      <img id="volume_mute" src="media/img/ui/mute.png" alt="">
      <img id="volume_voice" src="media/img/ui/volume.png" alt="">
      <a-asset-item id="bg" src="media/models/bg.glb"></a-asset-item>
    </a-assets>

    <a-entity position="0 1.4 -3" guide></a-entity>

    <!-- Controladores para manos -->
    <!-- <a-entity id="leftHand" hand-tracking-grab-controls="hand: left;" obb-collider></a-entity> -->
    <!-- <a-entity id="rightHand" hand-tracking-grab-controls="hand: right;" obb-collider></a-entity> -->
    <a-entity id="leftHand" hand-tracking-grab-controls="hand: left;"></a-entity>
    <a-entity id="rightHand" hand-tracking-grab-controls="hand: right;"></a-entity>

    <!-- Cámara con look-controls y wasd-controls -->
<a-camera id="camara-cursor" wasd-controls look-controls>
  <!-- Anillo animado como cursor -->
  <a-entity 
    id="cursor-animado"
    position="0 0 -1" 
    material="color: green; shader: flat" 
    geometry="primitive: torus; radius: 0.05; radiusTubular: 0.005; segmentsTubular: 32; segmentsRadial: 3" 
    animation__arc="property: geometry.arc; from: 0; to: 360; loop: false; dur: 1000; easing: linear; enabled: false; autoplay: false;" 
    animation__segments="property: geometry.segmentsTubular; from: 1; to: 32; loop: false; dur: 1000; easing: linear; enabled: false; autoplay: false;" 
    raycaster="objects: .button"
    cursor="fuse: true; rayOrigin: entity">
  </a-entity>
</a-camera>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
    // Selecciona el cursor animado
    const cursorAnimado = document.querySelector("#cursor-animado");

    // Evento al entrar en un objeto interactivo
    cursorAnimado.addEventListener("raycaster-intersected", (evt) => {
        const intersectedEl = evt.detail.el;
        if (intersectedEl.classList.contains("button")) {
            cursorAnimado.setAttribute("animation__arc", "enabled", true);
            cursorAnimado.setAttribute("animation__segments", "enabled", true);

            // Reinicia la animación para que se ejecute nuevamente
            cursorAnimado.components["animation__arc"].beginAnimation();
            cursorAnimado.components["animation__segments"].beginAnimation();
        }
    });

    // Evento al salir de un objeto interactivo (opcional, si quieres deshabilitar algo al salir)
    cursorAnimado.addEventListener("raycaster-intersected-cleared", (evt) => {
        const intersectedEl = evt.detail.el;
        if (intersectedEl.classList.contains("button")) {
            cursorAnimado.setAttribute("animation__arc", "enabled", false);
            cursorAnimado.setAttribute("animation__segments", "enabled", false);
        }
    });
});

    </script>
    


    <!-- Caja Roja (Grabbable) -->
    <a-box grabbable 
       color="red" 
       scale="0.5 0.5 0.5" 
       position="0 0 -1" 
       dynamic-body>
    </a-box>
  </a-scene>

  <!-- Scripts Guides -->
  <script src="js/textToSpeech.js"></script>
  <script src="js/listeners.js"></script>
  <script src="js/guides.js"></script>
  
</body>
</html>
